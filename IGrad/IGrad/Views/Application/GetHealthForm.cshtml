@model IGrad.Models.User.UserModel
@{
    ViewBag.Title = "GetHealthForm";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@Scripts.Render("/Scripts/application.js")
@Styles.Render("/Content/healthform.css")
<script type="text/javascript">
    function loadMedicalInfoForm() {
        hideTarget('add-health-button');
        showTarget('add-health');
        $("#add-health").load('@Url.Action("GetAddHealthInfo", "Application")');
    }

</script>

<h3>Health Information</h3>
<small class="form-text required-marker-indicator">* required fields.</small>
<hr>

<div class="description-text">
    <p>
        This information is needed to plan an appropriate program for the student and to prepare for any emergency situation if one should arise. Your school nurse will contact you if there are any additional questions.
    </p>
</div>


<!-- CATEGORY 1 -->
<div id="medical-history">
    <div class="card">
        <div class="card-header" id="category-1-heading">
            <h4 class="mb-0">
                <button class="btn btn-link" data-toggle="collapse" data-target="#category-1" aria-expanded="true" aria-controls="category-1">
                    Health Category #1
                </button>
            </h4>
        </div>

        <div id="category-1" class="collapse" aria-labelledby="category-1-heading" data-parent="#medical-history">
            <div class="card-body">
                @{Html.RenderPartial("_HealthCategory1", Model.HealthInfo);}
            </div>
        </div>
    </div>


    <!-- CATEGORY 2 -->
    <div class="">
        <h4 class="mb-0" id="category-2-heading">
            <button class="btn btn-link" data-toggle="collapse" data-target="#category-2" aria-expanded="true" aria-controls="category-2">
                Health Category #2
            </button>
        </h4>
        <div id="category-2" class="collapse" aria-labelledby="category-2-heading" data-parent="#medical-history">
            @{Html.RenderPartial("_HealthCategory2", Model.HealthInfo);}
        </div>
    </div>
</div>



<script>
    $(document).ready(function () {
        $(".medical-information").hide();

        TrackChanges();
    });

    function TrackChanges() {
        $(':checkbox').change(function () {
            var currentCheckbox = $(this);
            var isChecked = currentCheckbox.is(':checked');

            var currentCheckboxID = currentCheckbox.attr('id');
            var currentCheckboxName = currentCheckbox.attr('name');

            if (currentCheckbox.hasClass("to-category-two")) {
                ProcessCategoryTwo(currentCheckboxID, isChecked);
            } else {
                ProcessCategoryOne(currentCheckboxName, isChecked);
            }
        });
    }

    function ProcessCategoryOne(currentCheckboxName, isChecked) {
        // enable or disable medical input based on checkbox value
        if (isChecked === true) {
            $("input[name*='" + currentCheckboxName + "Description']").removeAttr("disabled");
        } else {
            ($("input[name*='" + currentCheckboxName + "Description']")).attr("disabled", "disabled");
        }
    }

    function ProcessCategoryTwo(currentCheckboxID, isChecked) {
        var count = 2;

        if (isChecked === true) {
            $("#" + currentCheckboxID + "-information").show();
        }
        else {
            $("#" + currentCheckboxID + "-information").hide();
        }
    }
</script>